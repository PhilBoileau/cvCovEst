<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`cvCovEst`: Cross-Validated Covariance Matrix Estimation • cvCovEst</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`cvCovEst`: Cross-Validated Covariance Matrix Estimation">
<meta property="og:description" content="cvCovEst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cvCovEst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using_cvCovEst.html">`cvCovEst`: Cross-Validated Covariance Matrix Estimation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PhilBoileau/cvCovEst/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>cvCovEst</code>: Cross-Validated
Covariance Matrix Estimation</h1>
                        <h4 data-toc-skip class="author">
<a href="https://pboileau.ca" class="external-link">Philippe Boileau</a>, <a href="https://github.com/bcollica" class="external-link">Brian Collica</a>, <a href="https://nimahejazi.org" class="external-link">Nima Hejazi</a>
</h4>
            
            <h4 data-toc-skip class="date">2022-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PhilBoileau/cvCovEst/blob/HEAD/vignettes/using_cvCovEst.Rmd" class="external-link"><code>vignettes/using_cvCovEst.Rmd</code></a></small>
      <div class="hidden name"><code>using_cvCovEst.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="background-and-motivation">Background and Motivation<a class="anchor" aria-label="anchor" href="#background-and-motivation"></a>
</h3>
<p>When the number of observations in a dataset far exceeds the number
of features, the estimator of choice for the covariance matrix is the
sample covariance matrix. It is an efficient estimator under minimal
regularity assumptions on the data-generating distribution. In
high-dimensional regimes, however, this estimator leaves much to be
desired: The sample covariance matrix is either singular, numerically
unstable, or both, thereby amplifying estimation error.</p>
<p>As high-dimensional data have become widespread, researchers have
derived many novel covariance matrix estimators to remediate the sample
covariance matrix’s deficiencies. These estimators come in many
flavours, though most are constructed by regularizing the sample
covariance matrix, or through the estimation of latent factors. A
comprehensive review is provided by <span class="citation">Fan, Liao,
and Liu (2016)</span>.</p>
<p>This variety brings with it many challenges. Identifying an “optimal”
estimator from among a collection of candidates can prove a daunting
task, one whose objectivity is often compromised by the analyst’s
decisions. Though data-driven approaches for selecting an optimal
estimator from among estimators belonging to certain (limited) classes
have been derived, the question of selecting an estimator from among a
diverse collection of candidates remains unaddressed.</p>
<p>We therefore offer a general, cross-validation-based framework for
covariance matrix estimator selection to tackle just that. The
high-dimensional asymptotic optimality of selections are guaranteed
based upon extensions of the seminal work of <span class="citation">Dudoit and van der Laan (2003)</span>, <span class="citation">Dudoit and van der Laan (2005)</span>, and <span class="citation">van der Vaart, Dudoit, and van der Laan (2006)</span>
on data-adaptive estimator selection to high-dimensional covariance
matrix estimation <span class="citation">(Boileau et al. 2021)</span>.
The interested reader is invited to review theoretical underpinnings of
the methodology as described in <span class="citation">Boileau et al.
(2021)</span>.</p>
</div>
<div class="section level3">
<h3 id="cross-validated-covariance-matrix-estimation">Cross-validated Covariance Matrix Estimation<a class="anchor" aria-label="anchor" href="#cross-validated-covariance-matrix-estimation"></a>
</h3>
<p>Let there be a high-dimensional dataset comprising <span class="math inline">\(n\)</span> realizations of <span class="math inline">\(i.i.d.\)</span> <span class="math inline">\(p\)</span>-length random vectors with a possibly
nonparametric data-generating distribution. Our goal is to estimate
these random vectors’ covariance matrix, which may be accomplished using
our general cross-validated estimator selection framework.</p>
<p>Given a library of candidate estimators, a loss function, and a
choice of cross-validation scheme, <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> will identify
the asymptotically optimal estimator of the covariance matrix from among
all candidates. It subsequently estimates this parameter using the
selected candidate. An example is provided below. Lists and brief
descriptions of implemented candidate estimators, loss functions, and
cross-validation schemes are provided in the sequel.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'MASS' was built under R version 4.1.2</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PhilBoileau/cvCovEst" class="external-link">cvCovEst</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## cvCovEst v1.2.0: Cross-Validated Covariance Matrix Estimation</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1584</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate a 50x50 covariance matrix with unit variances and off-diagonal</span></span>
<span><span class="co"># elements equal to 0.5</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow <span class="op">=</span> <span class="fl">50</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample 50 observations from multivariate normal with mean = 0, var = Sigma</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run CV-selector</span></span>
<span><span class="va">cv_cov_est_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cvCovEst.html">cvCovEst</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">dat</span>,</span>
<span>    estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">linearShrinkLWEst</span>, <span class="va">denseLinearShrinkEst</span>,</span>
<span>      <span class="va">thresholdingEst</span>, <span class="va">poetEst</span>, <span class="va">sampleCovEst</span></span>
<span>    <span class="op">)</span>,</span>
<span>    estimator_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      thresholdingEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      poetEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    cv_loss <span class="op">=</span> <span class="va">cvMatrixFrobeniusLoss</span>,</span>
<span>    cv_scheme <span class="op">=</span> <span class="st">"v_fold"</span>,</span>
<span>    v_folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># print the table of risk estimates</span></span>
<span><span class="va">cv_cov_est_out</span><span class="op">$</span><span class="va">risk_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 9 × 3</span></span></span>
<span><span class="co">##   estimator            hyperparameters      cv_risk</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> linearShrinkLWEst    hyperparameters = NA    357.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> poetEst              lambda = 0.2, k = 1     369.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> poetEst              lambda = 0.2, k = 2     372.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> poetEst              lambda = 0.1, k = 2     375.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> poetEst              lambda = 0.1, k = 1     376.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> denseLinearShrinkEst hyperparameters = NA    379.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> sampleCovEst         hyperparameters = NA    379.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span> thresholdingEst      gamma = 0.2             384.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">9</span> thresholdingEst      gamma = 0.4             505.</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print a subset of the selected estimator's estimate</span></span>
<span><span class="va">cv_cov_est_out</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]</span></span>
<span><span class="co">## [1,] 1.1725637 0.5219385 0.4813226 0.5576840 0.6719526</span></span>
<span><span class="co">## [2,] 0.5219385 0.9364171 0.5591108 0.4390799 0.6766744</span></span>
<span><span class="co">## [3,] 0.4813226 0.5591108 1.0150440 0.4052703 0.6436765</span></span>
<span><span class="co">## [4,] 0.5576840 0.4390799 0.4052703 0.9826984 0.4304168</span></span>
<span><span class="co">## [5,] 0.6719526 0.6766744 0.6436765 0.4304168 1.0883278</span></span></code></pre>
<div class="section level4">
<h4 id="candidate-estimators">Candidate Estimators<a class="anchor" aria-label="anchor" href="#candidate-estimators"></a>
</h4>
<p>Covariance matrix estimators implemented in the <code>cvCovEst</code>
package are catalogued in the following table. These estimators are fed
to the <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> function through the
<code>estimators</code> argument as a vector. If these estimators rely
on hyperparameters, then they must be passed to the
<code>estimator_params</code> as a list. Depending on one’s assumptions
— or lack thereof — about the true covariance matrix, one may choose to
use a subset of these estimators or all of them. Of course, they may
also be used as standalone functions.</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="30%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th>Estimator</th>
<th>Implementation</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sample covariance matrix</td>
<td><code><a href="../reference/sampleCovEst.html">sampleCovEst()</a></code></td>
<td>The sample covariance matrix.</td>
</tr>
<tr class="even">
<td>Hard thresholding <span class="citation">(Bickel and Levina
2008b)</span>
</td>
<td><code><a href="../reference/thresholdingEst.html">thresholdingEst()</a></code></td>
<td>Applies a hard thresholding operator to the entries of the sample
covariance matrix.</td>
</tr>
<tr class="odd">
<td>SCAD thresholding <span class="citation">(Rothman, Levina, and Zhu
2009; Fan and Li 2001)</span>
</td>
<td><code><a href="../reference/scadEst.html">scadEst()</a></code></td>
<td>Applies the SCAD thresholding operator to the entries of the sample
covariance matrix.</td>
</tr>
<tr class="even">
<td>Adaptive LASSO <span class="citation">(Rothman, Levina, and Zhu
2009)</span>
</td>
<td><code><a href="../reference/adaptiveLassoEst.html">adaptiveLassoEst()</a></code></td>
<td>Applies the adaptive LASSO thresholding operator to the entries of
the sample covariance matrix.</td>
</tr>
<tr class="odd">
<td>Banding <span class="citation">(Bickel and Levina 2008a)</span>
</td>
<td><code><a href="../reference/bandingEst.html">bandingEst()</a></code></td>
<td>Replaces the sample covariance matrix’s off-diagonal bands by
zeros.</td>
</tr>
<tr class="even">
<td>Tapering <span class="citation">(Cai, Zhang, and Zhou
2010)</span>
</td>
<td><code><a href="../reference/taperingEst.html">taperingEst()</a></code></td>
<td>Tapers the sample covariance matrix’s off-diagonal bands, eventually
replacing them by zeros.</td>
</tr>
<tr class="odd">
<td>Optimal Linear Shrinkage <span class="citation">(Ledoit and Wolf
2004)</span>
</td>
<td><code><a href="../reference/linearShrinkLWEst.html">linearShrinkLWEst()</a></code></td>
<td>Asymptotically optimal shrinkage of the sample covariance matrix
towards the identity.</td>
</tr>
<tr class="even">
<td>Linear Shrinkage <span class="citation">(Ledoit and Wolf
2004)</span>
</td>
<td><code><a href="../reference/linearShrinkEst.html">linearShrinkEst()</a></code></td>
<td>Shrinkage of the sample covariance matrix towards the identity, but
the shrinkage is controlled by a hyperparameter.</td>
</tr>
<tr class="odd">
<td>Dense Linear Shrinkage <span class="citation">(Schäfer and Strimmer
2005)</span>
</td>
<td><code><a href="../reference/denseLinearShrinkEst.html">denseLinearShrinkEst()</a></code></td>
<td>Asymptotically optimal shrinkage of the sample covariance matrix
towards a dense matrix whose diagonal elements are the mean of the
sample covariance matrix’s diagonal, and whose off-diagonal elements are
the mean of the sample covariance matrix’s off-diagonal elements.</td>
</tr>
<tr class="even">
<td>Nonlinear Shrinkage <span class="citation">(Ledoit and Wolf
2018)</span>
</td>
<td><code><a href="../reference/nlShrinkLWEst.html">nlShrinkLWEst()</a></code></td>
<td>Analytical estimator for the nonlinear shrinkage of the sample
covariance matrix.</td>
</tr>
<tr class="odd">
<td>POET <span class="citation">(Fan, Liao, and Mincheva
2013)</span>
</td>
<td><code><a href="../reference/poetEst.html">poetEst()</a></code></td>
<td>An estimator based on latent variable estimation and
thresholding.</td>
</tr>
<tr class="even">
<td>Robust POET <span class="citation">(Fan, Liu, and Wang
2018)</span>
</td>
<td><code><a href="../reference/robustPoetEst.html">robustPoetEst()</a></code></td>
<td>A robust (and more computationally taxing) take on the POET
estimator.</td>
</tr>
<tr class="odd">
<td>Spiked Operator Loss Shrinkage <span class="citation">(Donoho,
Gavish, and Johnstone 2018)</span>
</td>
<td><code><a href="../reference/spikedOperatorShrinkEst.html">spikedOperatorShrinkEst()</a></code></td>
<td>The asymptotically optimal shrinkage estimator based on the operator
loss in a Gaussian spiked covariance model.</td>
</tr>
<tr class="even">
<td>Spiked Frobenius Loss Shrinkage <span class="citation">(Donoho,
Gavish, and Johnstone 2018)</span>
</td>
<td><code><a href="../reference/spikedFrobeniusShrinkEst.html">spikedFrobeniusShrinkEst()</a></code></td>
<td>The asymptotically optimal shrinkage estimator based on the
Frobenius loss in a Gaussian spiked covariance model.</td>
</tr>
<tr class="odd">
<td>Spiked Stein Loss Shrinkage <span class="citation">(Donoho, Gavish,
and Johnstone 2018)</span>
</td>
<td><code><a href="../reference/spikedSteinShrinkEst.html">spikedSteinShrinkEst()</a></code></td>
<td>The asymptotically optimal shrinkage estimator based on the Stein
loss in a Gaussian spiked covariance model.</td>
</tr>
</tbody>
</table>
<p>Note that <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> only functions with estimators
native to this package. If you’d like to request a new estimator
implementation, please submit an <a href="https://github.com/PhilBoileau/cvCovEst/issues" class="external-link">issue</a> to the
queue.</p>
</div>
<div class="section level4">
<h4 id="loss-functions">Loss Functions<a class="anchor" aria-label="anchor" href="#loss-functions"></a>
</h4>
<p>Given a collection of candidate estimators, <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code>
compares their conditional cross-validated risks to identify the optimal
selection. The loss function used to compute these risks should reflect
both aspects of the data-generating distribution and the goal of the
estimation procedure. This package currently implements three loss
functions:</p>
<table class="table">
<colgroup>
<col width="17%">
<col width="45%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th>Loss</th>
<th>Implementation</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Matrix-based Frobenius</td>
<td><code><a href="../reference/cvMatrixFrobeniusLoss.html">cvMatrixFrobeniusLoss()</a></code></td>
<td>The default, based on the Frobenius norm. Appropriate when the
dataset’s features are of similar magnitudes.</td>
</tr>
<tr class="even">
<td>Variance-scaled matrix-based Frobenius</td>
<td><code><a href="../reference/cvScaledMatrixFrobeniusLoss.html">cvScaledMatrixFrobeniusLoss()</a></code></td>
<td>A scaled version of the matrix-based Frobenius loss, where weights
are the inverse of products from the sample covariance matrix’s
diagonal. Appropriate when the features of the dataset are of different
magnitudes.</td>
</tr>
<tr class="odd">
<td>Observation-based Frobenius</td>
<td><code><a href="../reference/cvFrobeniusLoss.html">cvFrobeniusLoss()</a></code></td>
<td>Based on the Frobenius norm and the rank-1, observation-level
estimates of the sample covariance matrix. Its selections are equivalent
to that of the matrix-based Frobenius, though less computationally
efficient. However, the optimality results of <span class="citation">Boileau et al. (2021)</span> rely on it.</td>
</tr>
</tbody>
</table>
<p>The choice of loss function is set trough the <code>cv_loss</code>
argument. Like the candidate estimators, <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> only
supports loss functions implemented in this package. Please submit
suggestions to the <a href="https://github.com/PhilBoileau/cvCovEst/issues" class="external-link">issue</a>
queue.</p>
</div>
<div class="section level4">
<h4 id="supported-cross-validation-schemes">Supported Cross-Validation Schemes<a class="anchor" aria-label="anchor" href="#supported-cross-validation-schemes"></a>
</h4>
<p>Two cross-validation schemes are currently supported by
<code><a href="../reference/cvCovEst.html">cvCovEst()</a></code>. Please consider filing an <a href="https://github.com/PhilBoileau/cvCovEst/issues" class="external-link">issue</a> in the
queue to request the implementation of another cross-validation
scheme.</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Scheme</th>
<th>Details</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>V-fold</td>
<td>To use V-fold cross-validation, set the <code>cv_scheme</code>
argument in <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> to <code>"v_fold"</code>, and set
the number of folds through the <code>v_folds</code> argument.
<code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> defaults to 5-fold cross-validation.</td>
</tr>
<tr class="even">
<td>Monte-Carlo</td>
<td>To perform Monte-Carlo cross-validation, set the
<code>cv_scheme</code> argument to <code>"mc"</code>. Set the proportion
of data to be used in each validation set using the
<code>mc_split</code> argument, and the number of iterations to perform
with the <code>v_folds</code> argument.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="diagnostic-tools">Diagnostic Tools<a class="anchor" aria-label="anchor" href="#diagnostic-tools"></a>
</h3>
<p>In addition to selecting an optimal estimator, the
<code>cvCovEst</code> package contains summary and plotting methods
which highlight the statistical properties of the candidate estimators,
and inform the performance of the selection framework. These tools help
build intuition about these estimators’ behavior and allows for the
evaluation of their performance over varying inputs.</p>
<div class="section level4">
<h4 id="summary-method">Summary Method<a class="anchor" aria-label="anchor" href="#summary-method"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for <code>cvCovEst</code> accepts
an <code>object</code> argument, a named <code>list</code> of class
<code>cvCovEst</code>, a <code>dat_orig</code> argument, the original
data used to calculate the covariance matrix estimates, and a
<code>summ_fun</code> argument, a character vector specifying the type
of summary function to use.</p>
<p>These summary functions allow the user to quickly compare the
performance of several classes of estimators and compute other metrics
of interest. The choices of <code>summ_fun</code> and their outputs are
described below:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="42%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th>Summary</th>
<th>Implementation</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Empirical Risk by Estimator Class</td>
<td><code>empRiskByClass</code></td>
<td>Returns the minimum, 1<sup>st</sup> quartile, median, 3<sup>rd</sup>
quartile, and maximum of the empirical risk associated with each class
of estimator passed to <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code>.</td>
</tr>
<tr class="even">
<td>Best Performing Estimator by Class</td>
<td><code>bestInClass</code></td>
<td>Returns the specific hyperparameters, if applicable, of the best
performing estimator within each class along with additional
metrics.</td>
</tr>
<tr class="odd">
<td>Worst Performing Estimator by Class</td>
<td><code>worstInClass</code></td>
<td>Returns the specific hyperparameters, if applicable, of the worst
performing estimator within each class along with additional
metrics.</td>
</tr>
<tr class="even">
<td>Empirical Risk by Hyperparameter</td>
<td><code>hyperRisk</code></td>
<td>For estimators that take hyperparameters as arguments, this returns
the hyperparameters associated with the minimum, 1<sup>st</sup>
quartile, median, 3<sup>rd</sup> quartile, and maximum of the empirical
risk within each class of estimator. Each class has its own
<code>tibble</code> which are returned as a <code>list</code>.</td>
</tr>
</tbody>
</table>
<p>When either <code>bestInClass</code> or <code>worstInClass</code> is
specified, the additional metrics are the condition number, the sign,
and the sparsity. Sign refers to the estimate’s sign and is one of
positive-definite (<code>"PD"</code>), positive-semi-definite (“PSD”),
negative-definite (“ND”), negative-semi-definite (“NSD”), or indefinite
(“IND”). If an estimate results in a zero matrix, then the sign is
returned as <code>"NA"</code>. Sparsity is calculated at the proportion
of total entries in the estimate which are equal to zero.</p>
</div>
<div class="section level4">
<h4 id="plot-method">Plot Method<a class="anchor" aria-label="anchor" href="#plot-method"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for <code>cvCovEst</code> allows users
to visualize three main <code>plot_type</code>s of the candidate
estimators: covariance heat maps (<code>heatmap</code>), eigenvalue
plots (<code>eigen</code>), and the empirical risk (<code>risk</code>)
as a function of the hyperparameters (for applicable estimator classes).
If users do not specify a plot type, then all three plots are combined
into one figure for the optimal estimator selected by
<code><a href="../reference/cvCovEst.html">cvCovEst()</a></code>. Users can also achieve this by setting
<code>plot_type = "summary"</code>.</p>
<p>The heat maps and eigenvalue plots facilitate comparisons both within
and between estimator classes by allowing multiple values to be passed
as <code>estimator</code> and <code>stat</code> arguments.</p>
<p>Additional arguments specific to each <code>plot_type</code> are
outlined below:</p>
<div class="section level5">
<h5 id="heat-map">Heat Map<a class="anchor" aria-label="anchor" href="#heat-map"></a>
</h5>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td>abs_v</td>
<td>If <code>TRUE</code>, then the absolute value of the covariance is
mapped. Otherwise, the signed value is used.</td>
</tr></tbody>
</table>
</div>
<div class="section level5">
<h5 id="eigenvalue-plot">Eigenvalue Plot<a class="anchor" aria-label="anchor" href="#eigenvalue-plot"></a>
</h5>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>leading</td>
<td>If <code>TRUE</code>, then the k leading eigenvalues are displayed.
Otherwise, the k trailing eigenvalues are displayed.</td>
</tr>
<tr class="even">
<td>k</td>
<td>The number of leading or trailing eigenvalues to plot.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5">
<h5 id="empirical-risk">Empirical Risk<a class="anchor" aria-label="anchor" href="#empirical-risk"></a>
</h5>
<p>These two additional arguments only apply to estimators with multiple
hyperparameters:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>switch_vars</td>
<td>If <code>TRUE</code>, the hyperparameters used for the x-axis and
factor variables are switched.</td>
</tr>
<tr class="even">
<td>min_max</td>
<td>If <code>TRUE</code>, only the minimum and maximum values of the
factor hyperparameter will be used.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulated-data-analysis-example">Simulated Data Analysis Example<a class="anchor" aria-label="anchor" href="#simulated-data-analysis-example"></a>
</h2>
<p>To show how the plot and summary methods can be used, data is
simulated from a predetermined covariance matrix following a Toeplitz
structure. The data is then passed to <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> along with
a handful of estimators.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1584</span><span class="op">)</span></span>
<span></span>
<span><span class="va">toep_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">rho</span>, <span class="va">alpha</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">times</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="va">H</span> <span class="op">&lt;-</span> <span class="va">H</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">*</span> <span class="va">rho</span></span>
<span>    <span class="va">covmat</span> <span class="op">&lt;-</span> <span class="va">H</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">sign_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">times</span>,</span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>          <span class="va">times</span>,</span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">covmat</span> <span class="op">*</span> <span class="va">sign_mat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># simulate a 100 x 100 covariance matrix</span></span>
<span><span class="va">sim_covmat</span> <span class="op">&lt;-</span> <span class="fu">toep_sim</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">100</span>, rho <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample 75 observations from multivariate normal mean = 0, var = sim_covmat</span></span>
<span><span class="va">sim_dat</span> <span class="op">&lt;-</span>  <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">sim_covmat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run CV-selector</span></span>
<span><span class="va">cv_cov_est_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cvCovEst.html">cvCovEst</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">sim_dat</span>,</span>
<span>  estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">linearShrinkEst</span>, <span class="va">thresholdingEst</span>, <span class="va">bandingEst</span>, <span class="va">adaptiveLassoEst</span>,</span>
<span>    <span class="va">sampleCovEst</span>, <span class="va">taperingEst</span></span>
<span>  <span class="op">)</span>,</span>
<span>  estimator_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    linearShrinkEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    thresholdingEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bandingEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">10L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    adaptiveLassoEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    taperingEst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">10L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  cv_scheme <span class="op">=</span> <span class="st">"v_fold"</span>,</span>
<span>  v_folds <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="summary-method-1">Summary Method<a class="anchor" aria-label="anchor" href="#summary-method-1"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method is then used to compare the best
performing estimators in each class:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span><span class="op">)</span></span>
<span><span class="va">cv_sum</span><span class="op">$</span><span class="va">bestInClass</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">##   estimator        hyperparameter       cv_risk cond_num sign  sparsity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> taperingEst      k = 6                   555.  9.26<span style="color: #949494;">e</span> 1 PD        0.89</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> bandingEst       k = 4                   557. -<span style="color: #BB0000;">1.35</span><span style="color: #949494;">e</span> 2 IND       0.91</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> adaptiveLassoEst lambda = 0.25, n = 2    570. -<span style="color: #BB0000;">3.3</span> <span style="color: #949494;">e</span> 1 IND       0.93</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> thresholdingEst  gamma = 0.35            574. -<span style="color: #BB0000;">1.48</span><span style="color: #949494;">e</span> 1 IND       0.96</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> linearShrinkEst  alpha = 0.45            593.  6.65<span style="color: #949494;">e</span> 0 PD        0   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> sampleCovEst     hyperparameters = NA    667.  2.14<span style="color: #949494;">e</span>16 PD        0</span></span></code></pre>
<p>In this case, the tapering estimator with <code>k = 6</code> achieves
the lowest empirical risk. It is also one of the few positive definite
matrices, though its condition number is worse than that of the linear
shrinkage estimator’s estimate. The resulting estimate is also less
sparse than that of the other sparsity-enforcing estimators “best”
estimates.</p>
<p>We can take a closer look at the estimator’s performance based on
other possible hyperparameter values by hashing <code>taperingEst</code>
from the <code>hyperRisk</code> list.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_sum</span><span class="op">$</span><span class="va">hyperRisk</span><span class="op">$</span><span class="va">taperingEst</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   hyperparameters cv_risk stat  </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> k = 6           555     min   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> k = 6           555     Q1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> k = 6           555     median</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> k = 4           558     Q3    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> k = 2           572     max</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="plot-method-1">Plot Method<a class="anchor" aria-label="anchor" href="#plot-method-1"></a>
</h4>
<p>By specifying <code>plot_type = "risk"</code>, we can see the change
in empirical risk as the value of <code>k</code> changes. A summary of
the cross-validation scheme and loss function is displayed at the bottom
of all <code>cvCovEst</code> plot outputs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"risk"</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/risk-sim-1.png" width="384"></p>
<p>We can also examine the matrix structure as the value of
<code>k</code> changes. Examining the overall sparsity of the resulting
estimator can be useful since, in some cases, the assumption of sparsity
is not warranted. Note that the absolute values of the estimate’s
entries are displayed to emphasize the structural differences between
choices of hyperparameters.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"heatmap"</span>,</span>
<span>     stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"median"</span>, <span class="st">"max"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/multi-heat-sim-1.png" width="672"></p>
<p>If the signs of the covariances are of interest, they can be
displayed by setting <code>abs_v = FALSE</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"heatmap"</span>,</span>
<span>     stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"median"</span>, <span class="st">"max"</span><span class="op">)</span>, abs_v <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/sign-multi-heat-sim-1.png" width="672"></p>
<p>The difference between the optimal estimator selected by
<code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> and the sample covariance matrix is clear when
displaying their respective heat maps side by side.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"heatmap"</span>,</span>
<span>     estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taperingEst"</span>, <span class="st">"sampleCovEst"</span><span class="op">)</span>,</span>
<span>     stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span><span class="op">)</span>, abs_v <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/samp-heat-sim-1.png" width="480"></p>
<p>We may also be interested in the eigenvalues of the various banding
estimators. The distribution of eigenvalues relays information such as
the condition number or the positive-definiteness of the resulting
estimator. As with the other plot types, if the <code>estimator</code>
argument is not specified, the default is to display the optimal
estimator selected by <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"eigen"</span>,</span>
<span>     stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"median"</span>, <span class="st">"max"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/eigen-sim-1.png" width="480"></p>
<p>Specifying multiple values in the <code>estimator</code> argument
allows us compare the eigenvalues of the other estimator classes as
well.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span>, plot_type <span class="op">=</span> <span class="st">"eigen"</span>,</span>
<span>     stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"median"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>     estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taperingEst"</span>, <span class="st">"bandingEst"</span>, <span class="st">"linearShrinkEst"</span>,</span>
<span>                    <span class="st">"adaptiveLassoEst"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/multi-eigen-sim-1.png" width="576"></p>
<p>As previously mentioned, simply calling the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on
the output of <code><a href="../reference/cvCovEst.html">cvCovEst()</a></code> and providing the original data
will result in a visual summary of the selected estimator.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_cov_est_sim</span>, dat_orig <span class="op">=</span> <span class="va">sim_dat</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_cvCovEst_files/figure-html/plot-summary-1.png" width="816"></p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bickel2008_banding" class="csl-entry">
Bickel, Peter J., and Elizaveta Levina. 2008a. <span>“Regularized
Estimation of Large Covariance Matrices.”</span> <em>Annals of
Statistics</em> 36 (1): 199–227. <a href="https://doi.org/10.1214/009053607000000758" class="external-link">https://doi.org/10.1214/009053607000000758</a>.
</div>
<div id="ref-Bickel2008_thresh" class="csl-entry">
———. 2008b. <span>“Covariance Regularization by Thresholding.”</span>
<em>Annals of Statistics</em> 36 (6): 2577–2604. <a href="https://doi.org/10.1214/08-AOS600" class="external-link">https://doi.org/10.1214/08-AOS600</a>.
</div>
<div id="ref-boileau2021" class="csl-entry">
Boileau, Philippe, Nima S. Hejazi, Mark J. van der Laan, and Sandrine
Dudoit. 2021. <span>“Cross-Validated Loss-Based Covariance Matrix
Estimator Selection in High Dimensions.”</span> <a href="https://arxiv.org/abs/2102.09715" class="external-link">https://arxiv.org/abs/2102.09715</a>.
</div>
<div id="ref-cai2010" class="csl-entry">
Cai, T. Tony, Cun-Hui Zhang, and Harrison H. Zhou. 2010. <span>“Optimal
Rates of Convergence for Covariance Matrix Estimation.”</span> <em>Ann.
Statist.</em> 38 (4): 2118–44. <a href="https://doi.org/10.1214/09-AOS752" class="external-link">https://doi.org/10.1214/09-AOS752</a>.
</div>
<div id="ref-donoho2018" class="csl-entry">
Donoho, David, Matan Gavish, and Iain Johnstone. 2018. <span>“<span class="nocase">Optimal shrinkage of eigenvalues in the spiked covariance
model</span>.”</span> <em>The Annals of Statistics</em> 46 (4): 1742–78.
</div>
<div id="ref-laan_dudoit:2003" class="csl-entry">
Dudoit, Sandrine, and Mark J van der Laan. 2003. <span>“Asymptotics of
Cross-Validated Risk Estimation in Estimator Selection and Performance
Assessment.”</span> Working Paper 126. U.c. Berkeley Division of
Biostatistics Working Paper Series. Berkeley: University of California,
Berkeley. <a href="https://biostats.bepress.com/ucbbiostat/paper126/" class="external-link">https://biostats.bepress.com/ucbbiostat/paper126/</a>.
</div>
<div id="ref-dudoit2005" class="csl-entry">
Dudoit, Sandrine, and Mark J. van der Laan. 2005. <span>“Asymptotics of
Cross-Validated Risk Estimation in Estimator Selection and Performance
Assessment.”</span> <em>Statistical Methodology</em> 2 (2): 131–54.
</div>
<div id="ref-fan2001" class="csl-entry">
Fan, Jianqing, and Runze Li. 2001. <span>“Variable Selection via
Nonconcave Penalized Likelihood and Its Oracle Properties.”</span>
<em>Journal of the American Statistical Association</em> 96 (456):
1348–60. <a href="https://doi.org/10.1198/016214501753382273" class="external-link">https://doi.org/10.1198/016214501753382273</a>.
</div>
<div id="ref-fan2016" class="csl-entry">
Fan, Jianqing, Yuan Liao, and Han Liu. 2016. <span>“An Overview of the
Estimation of Large Covariance and Precision Matrices.”</span> <em>The
Econometrics Journal</em> 19 (1): C1–32. <a href="https://doi.org/10.1111/ectj.12061" class="external-link">https://doi.org/10.1111/ectj.12061</a>.
</div>
<div id="ref-fan2013" class="csl-entry">
Fan, Jianqing, Yuan Liao, and Martina Mincheva. 2013. <span>“Large
Covariance Estimation by Thresholding Principal Orthogonal
Complements.”</span> <em>Journal of the Royal Statistical Society.
Series B (Statistical Methodology)</em> 75 (4): 603–80. <a href="https://www.jstor.org/stable/24772450" class="external-link">https://www.jstor.org/stable/24772450</a>.
</div>
<div id="ref-fan2018" class="csl-entry">
Fan, Jianqing, Han Liu, and Weichen Wang. 2018. <span>“Large Covariance
Estimation Through Elliptical Factor Models.”</span> <em>Ann.
Statist.</em> 46 (4): 1383–1414. <a href="https://doi.org/10.1214/17-AOS1588" class="external-link">https://doi.org/10.1214/17-AOS1588</a>.
</div>
<div id="ref-Ledoit2004" class="csl-entry">
Ledoit, Olivier, and Michael Wolf. 2004. <span>“A Well-Conditioned
Estimator for Large-Dimensional Covariance Matrices.”</span> <em>Journal
of Multivariate Analysis</em> 88 (2): 365–411. <a href="https://doi.org/10.1016/S0047-259X(03)00096-4" class="external-link">https://doi.org/10.1016/S0047-259X(03)00096-4</a>.
</div>
<div id="ref-Ledoit2020" class="csl-entry">
———. 2018. <span>“Analytical Nonlinear Shrinkage of Large-Dimensional
Covariance Matrices.”</span> 264. Department of Economics - University
of Zurich. <a href="https://EconPapers.repec.org/RePEc:zur:econwp:264" class="external-link">https://EconPapers.repec.org/RePEc:zur:econwp:264</a>.
</div>
<div id="ref-rothman2009" class="csl-entry">
Rothman, Adam J., Elizaveta Levina, and Ji Zhu. 2009. <span>“Generalized
Thresholding of Large Covariance Matrices.”</span> <em>Journal of the
American Statistical Association</em> 104 (485): 177–86. <a href="https://doi.org/10.1198/jasa.2009.0101" class="external-link">https://doi.org/10.1198/jasa.2009.0101</a>.
</div>
<div id="ref-shafer2005" class="csl-entry">
Schäfer, Juliane, and Korbinian Strimmer. 2005. <span>“A Shrinkage
Approach to Large-Scale Covariance Matrix Estimation and Implications
for Functional Genomics.”</span> <em>Statistical Applications in
Genetics and Molecular Biology</em> 4 (1). <a href="https://doi.org/10.2202/1544-6115.1175" class="external-link">https://doi.org/10.2202/1544-6115.1175</a>.
</div>
<div id="ref-vaart2006" class="csl-entry">
van der Vaart, Aad W, Sandrine Dudoit, and Mark J van der Laan. 2006.
<span>“Oracle Inequalities for Multi-Fold Cross Validation.”</span>
<em>Statistics and Decisions</em> 24: 351–71.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Philippe Boileau, Nima Hejazi, Brian Collica.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
