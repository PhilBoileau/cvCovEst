<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Robust POET Estimator for Elliptical Distributions — robustPoetEst • cvCovEst</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Robust POET Estimator for Elliptical Distributions — robustPoetEst"><meta property="og:description" content="robustPoetEst() implements the robust version of
Principal Orthogonal complEment Thresholding (POET) estimator, a
nonparametric, unobserved-factor-based estimator of the covariance matrix
when the underlying distribution is elliptical
(Fan et al. 2018)
. The estimator is defined as the sum of the
sample covariance matrix's rank-k approximation and its
post-thresholding principal orthogonal complement. The rank-k
approximation is constructed from the sample covariance matrix, its leading
eigenvalues, and its leading eigenvectors.  The sample covariance matrix and
leading eigenvalues are initially estimated via an M-estimation procedure
and the marginal Kendall's tau estimator. The leading eigenvectors are
estimated using spatial Kendall's tau estimator. The hard thresholding
function is used to regularize the idiosyncratic errors' estimated
covariance matrix, though other regularization schemes could be used.
We do not recommend that this estimator be employed when
the estimand is the correlation matrix. The diagonal entries of the
resulting estimate are not guaranteed to be equal to one."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cvCovEst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/using_cvCovEst.html">`cvCovEst`: Cross-Validated Covariance Matrix Estimation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PhilBoileau/cvCovEst/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Robust POET Estimator for Elliptical Distributions</h1>
    <small class="dont-index">Source: <a href="https://github.com/PhilBoileau/cvCovEst/blob/HEAD/R/estimators.R" class="external-link"><code>R/estimators.R</code></a></small>
    <div class="hidden name"><code>robustPoetEst.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>robustPoetEst()</code> implements the robust version of
Principal Orthogonal complEment Thresholding (POET) estimator, a
nonparametric, unobserved-factor-based estimator of the covariance matrix
when the underlying distribution is elliptical
(Fan et al. 2018)
. The estimator is defined as the sum of the
sample covariance matrix's rank-<code>k</code> approximation and its
post-thresholding principal orthogonal complement. The rank-<code>k</code>
approximation is constructed from the sample covariance matrix, its leading
eigenvalues, and its leading eigenvectors.  The sample covariance matrix and
leading eigenvalues are initially estimated via an M-estimation procedure
and the marginal Kendall's tau estimator. The leading eigenvectors are
estimated using spatial Kendall's tau estimator. The hard thresholding
function is used to regularize the idiosyncratic errors' estimated
covariance matrix, though other regularization schemes could be used.</p>
<p>We do not recommend that this estimator be employed when
the estimand is the correlation matrix. The diagonal entries of the
resulting estimate are not guaranteed to be equal to one.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">robustPoetEst</span><span class="op">(</span><span class="va">dat</span>, <span class="va">k</span>, <span class="va">lambda</span>, var_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="st">"mad"</span>, <span class="st">"huber"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dat</dt>
<dd><p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p></dd>
<dt>k</dt>
<dd><p>An <code>integer</code> indicating the number of unobserved latent
factors. Empirical evidence suggests that the POET estimator is robust to
overestimation of this hyperparameter (Fan et al. 2013)
. In
practice, it is therefore preferable to use larger values.</p></dd>
<dt>lambda</dt>
<dd><p>A non-negative <code>numeric</code> defining the amount of
thresholding applied to each element of sample covariance matrix's
orthogonal complement.</p></dd>
<dt>var_est</dt>
<dd><p>A <code>character</code> dictating which variance estimator to
use. This must be one of the strings <code>"sample"</code>, <code>"mad"</code>, or
<code>"huber"</code>. <code>"sample"</code> uses sample variances; <code>"mad"</code>
estimates variances via median absolute deviation; <code>"huber"</code> uses an
M-estimator for variance under the Huber loss.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fan J, Liao Y, Mincheva M (2013).
“Large covariance estimation by thresholding principal orthogonal complements.”
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>75</b>(4), 603--680.
ISSN 13697412, 14679868, <a href="https://www.jstor.org/stable/24772450" class="external-link">https://www.jstor.org/stable/24772450</a>.<br><br> Fan J, Liu H, Wang W (2018).
“Large covariance estimation through elliptical factor models.”
<em>Ann. Statist.</em>, <b>46</b>(4), 1383--1414.
doi: <a href="https://doi.org/10.1214/17-AOS1588" class="external-link">10.1214/17-AOS1588</a>
.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">robustPoetEst</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">mtcars</span>, k <span class="op">=</span> <span class="fl">2L</span>, lambda <span class="op">=</span> <span class="fl">0.1</span>, var_est <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]        [,3]       [,4]         [,5]        [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]   36.315178  -9.1164387  -693.67785 -376.03067   2.11448003  -5.3349120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   -9.116439   2.7537461   190.39219  102.45344  -0.61276404   1.3986029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -693.677853 190.3921862 15358.02683 7267.79320 -46.11029191 110.9814745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -376.030665 102.4534357  7267.79320 4696.88357 -20.27007620  54.3234998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    2.114480  -0.6127640   -46.11029  -20.27008   0.21013981  -0.4787939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   -5.334912   1.3986029   110.98147   54.32350  -0.47879387   0.9573022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    5.076855  -1.7307761  -100.04564  -81.84586   0.04839227  -0.3844377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1.851765  -0.6218331   -38.85915  -22.17540   0.15703000  -0.2555406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1.484410  -0.3848420   -33.54033  -11.16801   0.20367457  -0.3061374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    2.280022  -0.6167975   -51.04325  -17.11729   0.18503478  -0.4043015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   -6.199445   1.4396723   107.50032   80.26554  -0.11182020   0.7713457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,7]         [,8]         [,9]       [,10]        [,11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    5.07685520   1.85176484   1.48440950   2.2800219  -6.19944529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   -1.73077606  -0.62183308  -0.38484203  -0.6167975   1.43967234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -100.04564404 -38.85915432 -33.54032586 -51.0432471 107.50032232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  -81.84586275 -22.17539543 -11.16800914 -17.1172950  80.26554184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0.04839227   0.15703000   0.20367457   0.1850348  -0.11182020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   -0.38443765  -0.25554058  -0.30613738  -0.4043015   0.77134565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    3.19310208   0.60378091  -0.16563939  -0.1499862  -1.85214514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0.60378091   0.11854837   0.03335364   0.1292760  -0.37857863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   -0.16563939   0.03335364   0.21142802   0.2100142  -0.04591921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]   -0.14998618   0.12927602   0.21001418   0.4573464   0.12806927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   -1.85214514  -0.37857863  -0.04591921   0.1280693   2.44068633</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philippe Boileau, Nima Hejazi, Brian Collica.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

